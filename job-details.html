<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stillingsannonse</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://career.talentech.com/css/job-details-style.css">
    <link rel="stylesheet" href="./css/naf-job-details.css">
    <link rel="stylesheet" href="./css/naf-index.css">
    <link rel="icon" type="image/x-icon" href="./files/NAF-logo.jpeg">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/ca38a06270.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script type="text/javascript" src="https://web106.reachmee.com/customerjs/helper.js"></script>

  <meta property="og:title" content="Ledig stilling hos NAF">
  <meta property="og:description" content="Vil du være med å ta oss inn i fremtiden? Neste kapittel i vår 100 år lange historie starter med deg!">
  <meta property="og:image" content="https://jobb.naf.no/files/NAF-social.jpg">
  <meta property="og:url" content="https://jobb.naf.no/job-details.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ledig stilling hos NAF">
  <meta name="twitter:description" content="Vil du være med å ta oss inn i fremtiden? Neste kapittel i vår 100 år lange historie starter med deg!">
  <meta name="twitter:image" content="https://jobb.naf.no/files/NAF-social.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:type" content="website">

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM fully loaded and parsed");
            
            const params = new URLSearchParams(window.location.search);
            const jobId = params.get('rmjob') ? parseInt(params.get('rmjob'), 10) : parseInt(params.get('jobId'), 10);
            console.log("Job ID:", jobId);

            fetch('https://api.talentech.io/reachmee/feed/wistrand')
                .then(response => response.json())
                .then(jobs => {
                    console.log("Jobs fetched:", jobs);
                    const job = jobs.find(job => job.ad_id === jobId);
                    if (job) {
                        console.log("Job found:", job);

                        // Update meta tags for social media sharing
                        let ogTitle = document.querySelector('meta[property="og:title"]');
                        let twitterTitle = document.querySelector('meta[name="twitter:title"]');
                        let ogDescription = document.querySelector('meta[property="og:description"]');
                        let twitterDescription = document.querySelector('meta[name="twitter:description"]');
                        
                        if (!ogTitle) {
                            ogTitle = document.createElement('meta');
                            ogTitle.setAttribute('property', 'og:title');
                            document.head.appendChild(ogTitle);
                        }
                        if (!twitterTitle) {
                            twitterTitle = document.createElement('meta');
                            twitterTitle.setAttribute('name', 'twitter:title');
                            document.head.appendChild(twitterTitle);
                        }
                        if (!ogDescription) {
                            ogDescription = document.createElement('meta');
                            ogDescription.setAttribute('property', 'og:description');
                            document.head.appendChild(ogDescription);
                        }
                        if (!twitterDescription) {
                            twitterDescription = document.createElement('meta');
                            twitterDescription.setAttribute('name', 'twitter:description');
                            document.head.appendChild(twitterDescription);
                        }

                        ogTitle.setAttribute('content', job.title);
                        twitterTitle.setAttribute('content', job.title);
                        ogDescription.setAttribute('content', job.description);
                        twitterDescription.setAttribute('content', job.description);

                        console.log("Meta tags updated");
                        console.log("og:title", ogTitle);
                        console.log("twitter:title", twitterTitle);
                        console.log("og:description", ogDescription);
                        console.log("twitter:description", twitterDescription);

                        // Optionally, also update the document title
                        document.title = job.title;
                        console.log("Document title updated");
                    } else {
                        console.error('Job not found.');
                    }
                })
                .catch(error => {
                    console.error('Error fetching job details:', error);
                });
        });
    </script>
</head>


<body>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const params = new URLSearchParams(window.location.search);
    const rmpage = params.get('rmpage');

    // Check if the rmpage parameter is set to 'profileactivate' or 'subscriptions'
    if (rmpage === 'profileactivate' || rmpage === 'subscriptions') {
        // Redirect to /profile with all existing query parameters
        window.location.href = '/profile.html?' + params.toString();
    }
});
</script>


<nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: rgba(0, 0, 0, 0.0);">
    <div class="container m-py-0">
        <a class="navbar-brand" href="./" aria-label="Home">
            <img src="./files/NAF-logo.jpeg" height="40" class="d-inline-block align-top" alt="">
        </a>
        <div class="d-flex justify-content-end align-items-center flex-grow-1">
            <a class="nav-link ml-auto d-lg-none btn btn-primary apply-btn m-mr-2" href="#appform-header">Søk nå</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
        <div class="d-flex d-lg-none my-2 mobile-only">
            <!--<a class="nav-link new-link mr-1" href="#tt-talentech-section-2">Møt folka <i class="fa-thin fa-arrow-down"></i></a>-->
            <a class="nav-link new-link ml-1" href="#recruitment-process">Rekrutteringsprosess <i class="fa-thin fa-arrow-down"></i></a>
        </div>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="./">Hjem <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#appform-header">Søk her</a>
                </li><!--
                <li class="nav-item">
                    <a class="nav-link" href="#tt-talentech-section-2">Møt folka</a>
                </li>-->
                <li class="nav-item">
                    <a class="nav-link" href="#recruitment-process">Rekrutteringsprosess</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://web106.reachmee.com/ext/I002/233/profile?site=5&validator=b026c105ea4a83b928726cb7cb18488c&lang=NO">Logg inn</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" target="blank" href="https://naf.no">naf.no <span class="sr-only">(current)</span></a>
                </li>
            </ul>
        </div>
    </div>
</nav>



<script>
$(document).ready(function() {
    if ($(window).width() <= 992) {
        $(".navbar").addClass("bg-dark");
    } else {
        $(window).scroll(function() {
            if ($(window).scrollTop() > 56) {
                $(".navbar").addClass("bg-dark");
            } else {
                $(".navbar").removeClass("bg-dark");
            }
        });
        $(".navbar-toggler").click(function() {
            if (!$(".navbar-collapse").hasClass("show")) {
                $(".navbar").addClass("bg-dark");
            } else {
                if ($(window).scrollTop() < 56) {
                    $(".navbar").removeClass("bg-dark");
                }
            }
        });
    }
});
</script>









    <div class="hero-section">
<div class="naf-hero"></div>
	    <div class="hero-content">
            <div class="job-title2" id="position-title"> </div>
            <p id="position-title-meta" style="font-size: 1.25rem;"><span class="organization-unit"> </span> • <span class="city"> </span></p>
        </div>
        <img src="./files/NAF-logo.jpeg" alt="NAF Logo" class="hero-logo">
    </div>


<!--
<script>
document.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    const jobId = params.get('rmjob') ? parseInt(params.get('rmjob'), 10) : parseInt(params.get('jobId'), 10);

    fetch('https://api.talentech.io/reachmee/feed/wistrand')
        .then(response => response.json())
        .then(jobs => {
            const job = jobs.find(job => job.ad_id === jobId);
            if (job) {
                // Your existing code to populate job details...

                // Check the occupation_area_id and modify the hero section if it's 28
                if (job.occupation_area_id === 28) {
                    const heroSection = document.querySelector('.hero-section');
                    heroSection.innerHTML = `
                        <div class="naf-hero"></div>
                        <video playsinline autoplay loop muted class="hero-video">
                            <source src="./files/NAF-senterne.mp4" type="video/mp4">
                        </video>
                        <div class="hero-content">
                            <div class="job-title2" id="position-title"> </div>
                            <p id="position-title-meta" style="font-size: 1.25rem;">
                                <span class="organization-unit"> </span> • <span class="city"> </span>
                            </p>
                        </div>
                    `;
                }
            } else {
                console.error('Job not found.');
            }
        })
        .catch(error => {
            console.error('Error fetching job details:', error);
        });
});
</script>
-->	
	
<div id="tt-job-section" class="job-section">
    <div class="container">
        <div class="row">
            <div class="col-md-3 col-6 job-info">
                <span class="job-info-title">Team</span>
                <span class="organization-unit">NAF-folka</span>
            </div>
            <div class="col-md-3 col-6 job-info">
                <span class="job-info-title">Sted</span>
                <span class="city">Location</span>
            </div>
            <div class="col-md-3 col-6 job-info">
                <span class="job-info-title">Søknadsfrist</span>
                <span class="expiration-date">Søknadsfrist</span>
            </div>
            <div class="col-md-3 col-6 text-center apply-btn-header">
<a href="#appform-header" class="btn btn-primary apply-btn" role="">Søk på stillingen</a>
            </div>
        </div>
    </div>
</div>



	
	
	
	<div id="tt-talentech-section-1" class="talentech-section mb-5 m-pb-3">
    <div class="container mt-5 pt-3 m-px-4 m-mt-4">
        <div id="inner-job-title" class="mb-5 job-title m-mb-4"> </div>


<!-- Share section -->
        <div class="container share-container mt-2 mt-sm-0 m-px-0 py-0">
            <span class="d-block d-sm-inline mb-1">
                <a href="#" id="facebook-share-link" target="_blank" rel="noopener noreferrer">
                    <img src="https://cdn.jsdelivr.net/npm/simple-icons/icons/facebook.svg" alt="Share on Facebook" width="18" height="18">
                </a>
                <a href="#" id="twitter-share-link" target="_blank" rel="noopener noreferrer">
                    <img src="https://cdn.jsdelivr.net/npm/simple-icons/icons/x.svg" alt="Share on X" width="18" height="18">
                </a>
                <a href="#" id="linkedin-share-link" target="_blank" rel="noopener noreferrer">
                    <img src="https://cdn.jsdelivr.net/npm/simple-icons/icons/linkedin.svg" alt="Share on LinkedIn" width="18" height="18">
                </a>
            </span>
        </div>
<!-- END Share section -->
    
	    
        <div class="my-3 job-description"> </div>
	    <div class="contact-persons"></div>
    </div>

            <div class="text-center centerd-apply-btn">
<a href="#appform-header" class="btn btn-primary apply-btn" role="">Søk på stillingen</a>
            </div>
</div>


<script>
document.addEventListener("DOMContentLoaded", function() {
    const params = new URLSearchParams(window.location.search);
    const rmpage = params.get('rmpage');

    if (rmpage === 'profileactivate') {
        loadExternalScriptAndBuildIframe();
    }
});

function loadExternalScriptAndBuildIframe() {
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = 'https://web106.reachmee.com/customerjs/I020-787-58.js';
    script.onload = function() {
        buildIframe();
    };
    document.head.appendChild(script);
}

function buildIframe() {
    var iFrameUrl = 'https://web106.reachmee.com/ext/';
    var validator = 'b026c105ea4a83b928726cb7cb18488c';
    var iid = 'I002';
    var customer = '233';
    var site = '5';
    var iHelperUrl = 'https://headlessjobsites.github.io/Wistrand/job-details.html?';
    var height = '4000';
    var langDef = 'UK';
    var title = 'ReachMee Recruit external site';

    // More URL building logic here, using the current script logic
    // Ensure the destination page is determined correctly
    var destPage = new URLSearchParams(window.location.search).get('rmpage') + '?';
    // Add other parameters based on your existing script logic

    iFrameUrl += destPage + 'site=' + site + '&validator=' + validator + '&lang=' + langDef;

    // Dynamically create the iframe
    var iframe = document.createElement('iframe');
    iframe.style.width = '100%';
    iframe.style.height = height + 'px';
    iframe.frameBorder = '0';
    iframe.title = title;
    iframe.src = iFrameUrl;

    var targetElement = document.getElementById('iframeContainer');
    if (!targetElement) {
        console.error('No element found to insert the iframe into');
        return;
    }
    targetElement.innerHTML = ''; // Clear previous content
    targetElement.appendChild(iframe);
}

</script>
<div id="iframeContainer"></div>






	

	

<!--
<section id="tt-talentech-section-2" class="team-section py-5 mb-0 pb-4 m-my-0 m-py-5">
        <center><h2 class="container mb-0 pt-5 pb-0"><div class="pt-4">Møt folka hos <span class="organization-unit" style="font-weight: 800;"></span></div></h2></center>
    <div class="container mt-0 pt-2 pb-5 m-ml-0 m-px-0"><div class="pb-3">
        <div class="row mt-3 pb-4 m-mt-2 m-mx-0">
<div id="gobi-section"></div>		
	</div>
        </div>
    </div>
</section>
-->	






<section class="process-section mb-5 py-5 m-my-0 m-pt-0 m-pb-4 recruitment-process-naf-senter" id="recruitment-process" style="">
    <div class="container pt-5 m-px-4 m-pb-2">
        <h2>Vår <span style="font-weight: 800;">rekrutterings&shy;prosess</span></h2>
    </div>
    <div class="container">
        <div class="row">
            <!--<div class="col-md-4 px-0">
<script src="https://widget.gobistories.com/gwi/6" async onload="gobi.discover()"></script>

<div class="gobi-collection" data-gobi-collection-id="585tn"></div>
            </div>-->
            <!-- Existing Content in Right Column -->
            <div class="col-md-12 m-px-4">
                <div class="row process-row">
                    <!-- Benefit 1 -->
                    <div class="col-md-3 col-sm-4 process-item">
                        <div class="process-icon">
                            <h3>1</h3>
                        </div>
                        <div class="process-content">
                            <h3>Send søknad</h3>
                            <p>Start reisen din ved å legge inn en enkel søknad gjennom vår karriereportal.</p>
                        </div>
                    </div>
                    <!-- Benefit 2 -->
                    <div class="col-md-3 col-sm-4 process-item">
                        <div class="process-icon">
                            <h3>2</>
                        </div>
                        <div class="process-content">
                            <h3>Gjennomgang av søkere</h3>
                            <p>Vi går igjennom alle søknadene, og kaller inn til intervju med aktuelle kandidater.</p>
                        </div>
                    </div>
                    <!-- Benefit 3 -->
                    <div class="col-md-3 col-sm-4 process-item">
                        <div class="process-icon">
                            <h3>3</h3>
                        </div>
                        <div class="process-content">
                            <h3>Intervjuprosess</h3>
                            <p>Vi tar en prat sammen om dine erfaringer, kompetanse, tanker om rollen, og NAF som arbeidsplass.</p>
                        </div>
                    </div>
                    <!-- Benefit 4 -->
                    <div class="col-md-3 col-sm-4 process-item">
                        <div class="process-icon">
                            <h3>4</h3>
                        </div>
                        <div class="process-content">
                            <h3>Tilbud og onboarding</h3>
                            <p>Hvis det er en match, vil vi gi et tilbud. Når det er akseptert, vil vi guide deg gjennom onboarding-prosessen.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



    <div class="container my-5 service-box-wrapper">
        <div class="row">
            <div class="col-12">
                <div class="service-box p-5 mx-3">
                    <div class="service-content">
                        <h6>Om NAF sentrene</h6>
                        <h2>Bli bedre kjent med oss</h2>
                        <p>NAF sentrene er en del av Norges Automobil-Forbund, og som en av Norges største egeneide bilverkstedkjede utfører vi EU-kontroller, NAF-tester, servicer og reparasjoner for både NAF-medlemmer, privat- og næringskunder.</p>
                        <a href="./naf-senter.html"><button class="btn btn-primary apply-btn">Les mer om NAF sentrene</button></a>
                    </div>
                    <div class="service-image">
                        <img src="./files/NAF-senter-4.jpg" alt="NAF Senter">
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    const jobId = params.get('rmjob') ? parseInt(params.get('rmjob'), 10) : parseInt(params.get('jobId'), 10);

    fetch('https://api.talentech.io/reachmee/feed/wistrand')
        .then(response => response.json())
        .then(jobs => {
            const job = jobs.find(job => job.ad_id === jobId);
            if (job) {
                // Your existing code to populate job details...

                // Check the occupation_area_id and hide sections if it's not 28
                if (job.occupation_area_id !== 28) {
                    document.querySelector('.service-box-wrapper').style.display = 'none';
                    document.querySelector('.recruitment-process-naf-senter').style.display = 'none';
                    document.querySelector('.new-link').style.display = 'none';
                }
            } else {
                console.error('Job not found.');
            }
        })
        .catch(error => {
            console.error('Error fetching job details:', error);
        });
});

</script>




<section class="process-section mb-5 m-my-0 m-pt-0 m-pb-4" style="">
    <h2 id="appform-header" class="container pt-5 m-px-3 m-pb-2" id="appFormWrapper"><span style="font-weight: 800;">Søknadsskjema</span></h2>
    <!-- Application form -->
    <div id="originalContentContainer">
        <div id="applicationFormContainer"></div>
    </div>
</section>
	
<script>
document.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    // Get 'rmjob' if present, otherwise get 'jobId'
    const jobId = params.get('rmjob') || params.get('jobId');

    // Fetch job details (assuming you have an endpoint to get job details by jobId)
    fetch(`https://api.talentech.io/reachmee/feed/wistrand`) // Replace with your actual API endpoint
        .then(response => response.json())
        .then(jobs => {
            const job = jobs.find(job => job.ad_id === parseInt(jobId));
            if (job && job.hide_apply_button) {
                // Display the message and button if hide_apply_button is true
                const messageContainer = document.createElement('div');
                messageContainer.innerHTML = `
                    <center><p>Søknadsskjema er deaktivert for denne stillingen. Se stillingsbeskrivelsen for å sende inn søknad.</p>
                    <a href="#tt-talentech-section-1" class="btn btn-primary">Se stillingstekst</a></center>
                `;
                document.getElementById('applicationFormContainer').appendChild(messageContainer);
            } else {
                // Display the application form if hide_apply_button is false
                if (!document.getElementById('applicationFormIframe')) {
                    const iframe = document.createElement('iframe');
                    iframe.style.width = "100%";
                    iframe.style.border = "none";
                    iframe.id = "applicationFormIframe";
                    const iframeSrc = `https://web106.reachmee.com/ext/I002/233/apply?job_id=${jobId}&site=5&validator=b026c105ea4a83b928726cb7cb18488c&lang=NO&ihelper=${encodeURIComponent('https://wistrand.attract.reachmee.com/jobs/rm?rmpage=job&rmjob=' + jobId)}`;
                    iframe.setAttribute('src', iframeSrc);
                    document.getElementById('applicationFormContainer').appendChild(iframe);
                }
            }
        })
        .catch(error => {
            console.error('Error fetching job details:', error);
        });
});

// Consolidate message listener, adding security check
window.addEventListener('message', function(event) {
    // Verify the origin of your iframe content
    const expectedOrigin = 'https://web106.reachmee.com';
    if (event.origin === expectedOrigin && typeof event.data === 'string' && event.data.startsWith('resize::')) {
        const height = event.data.split('resize::')[1];
        if (height) {
            document.getElementById('applicationFormIframe').style.height = height + 'px';
        }
    }
}, false);
</script>





	






	

	
<div id="tt-feature-section" class="feature-section mb-5 pt-3 pb-5" id="jobs-anchor" style="background-color: #eeeef2;">
<div class="container mt-3 mb-5 m-mb-0">
    <h2 class="my-5 m-my-0">Lignende <span style="font-weight: 800">jobber</span></h2>
    <div class="row my-3">
        <div class="col-md-3 mb-3">
            <label for="locationFilter">Steder</label>
            <select id="locationFilter" class="form-control">
                <option value="All">Alle steder</option>
                <!-- Location options will be dynamically added here -->
            </select>
        </div>
        <div class="col-md-3 mb-3">
            <label for="jobTypeFilter">Stillingstyper</label>
            <select id="jobTypeFilter" class="form-control">
                <option value="All">Alle stillingstyper</option>
                <!-- Job type options will be dynamically added here -->
            </select>
        </div>
    </div>
    <div id="jobList" class="row"></div>
	<div class="text-center mt-2">
    <button id="loadMore" class="btn btn-primary">Se flere</button>
	</div>
</div>
</div>



<div class="container my-5 py-5 m-my-0 m-pt-0" style="text-align: center;">
    <div class="agent-wrapper">
        <h2>Fant du ikke stillingen for deg?</h2>
        <div class="mt-4 mb-2">
		<p>Abonner på stillinger, så får du en e-post når det er en ledig stilling som passer dine preferanser.</p>
		</div>
    </div>
 

    <button id="agent" class="mt-3 btn btn-primary" style="font-weight:800">Registrer deg</button>


<div class="modal fade modal-fullscreen-90w" id="exampleModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" id="closeModalButton" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <iframe id="modalIframe" src="" style="border: none; width: 100%; height: 450px;"></iframe>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('agent').addEventListener('click', function() {
        var iframeUrl = "https://web106.reachmee.com/ext/I002/233/subscribe?site=5&lang=NO&validator=b026c105ea4a83b928726cb7cb18488c";
        document.getElementById('modalIframe').src = iframeUrl;
        $('#exampleModal').modal('show');
    });
});
</script>

</div>







<section class="text-center bg-dark text-light py-5">
    <div class="container naf-footer">
        <img src="./files/NAF-logo.jpeg" alt="NAF Logo" class="mb-3" style="max-width: 120px;">
                <div class="mt-3 mb-4" style="max-width: 600px; margin: auto;">
		 <p style="font-size: 1.25rem;">NAF er en av Norges mest kjente organisasjoner, med over 750.000 medlemmer og kunder. Det skal vi fortsette å være fremover, og da trenger vi flere gode medarbeidere, både i Forbundet, på våre øvingsbaner og ute på NAF-sentrene!</p>
		</div>
        <div class="">
            <a href="https://www.facebook.com/nafnorge"><img src="./files/TT-f.svg" alt="Icon 1" class="mx-2" style="width: 30px; height: 30px;"></a>
            <a href="https://www.linkedin.com/company/norges-automobil-forbund/"><img src="./files/TT-l.svg" alt="Icon 2" class="mx-2" style="width: 30px; height: 30px;"></a>
            <a href="https://www.naf.no/kundeservice" target="_blank"><img src="./files/TT-e.svg" alt="Icon 4" class="mx-2" style="width: 30px; height: 30px;"></a>
        </div>
    </div>
</section>





	

<script>
$(document).ready(function () {
    let jobs = []; // Array to store all jobs
    let displayedJobs = 0; // Counter for the number of jobs currently displayed
    const jobsToShowDesktop = 12; // Number of jobs to show on desktop before "Load More"
    const jobsToShowMobile = 6; // Number of jobs to show on mobile before "Load More"
    let jobsToShow = window.innerWidth > 768 ? jobsToShowDesktop : jobsToShowMobile;

    // Adjust jobsToShow based on window resize
    $(window).resize(function() {
        jobsToShow = window.innerWidth > 768 ? jobsToShowDesktop : jobsToShowMobile;
        displayedJobs = Math.min(jobsToShow, jobs.length); // Adjust displayedJobs based on new jobsToShow
        displayJobs(); // Redisplay jobs based on new size
        updateLoadMoreVisibility(); // Update button visibility after resize
    });

    // Function to populate filter dropdowns based on jobs
    function populateFilters() {
        const locationSet = new Set();
        const jobTypeSet = new Set();

        jobs.forEach(job => {
            if (job.country) { // Check if job has a country
                locationSet.add(job.country);
            }
            if (job.title) { // Check if job has a title
                jobTypeSet.add(job.title);
            }
        });

	    
	// Populate location filter
        $('#locationFilter').html('<option value="All">Alle steder</option>');
        locationSet.forEach(country => {
            $('#locationFilter').append(`<option value="${country}">${country}</option>`);
        });

        // Populate job type filter
        $('#jobTypeFilter').html('<option value="All">Alle stillingstytper</option>');
        jobTypeSet.forEach(type => {
            $('#jobTypeFilter').append(`<option value="${type}">${type}</option>`);
        });
    }

    // Function to display jobs based on filters
    function displayJobs() {
        $('#jobList').empty(); // Clear current jobs

        let filteredJobs = jobs.slice(0, displayedJobs); // Get the subset of jobs to be displayed

        // Apply filters
        const selectedCountry = $('#locationFilter').val();
        const selectedJobType = $('#jobTypeFilter').val();
        filteredJobs = filteredJobs.filter(job => {
            return (selectedCountry === 'All' || job.country === selectedCountry) &&
                   (selectedJobType === 'All' || job.title === selectedJobType);
        });

        // Add job cards to the DOM
        filteredJobs.forEach(job => {
            $('#jobList').append(buildJobCard(job));
        });

        updateLoadMoreVisibility(); // Update the visibility of the "Load More" button
    }

    // Function to build HTML for a job card
    function buildJobCard(job) {
    // Assuming job-details.html is your detail page and it can handle job IDs
    // Adjust accordingly if your detail page has a different URL structure
    const jobDetailUrl = `job-details.html?jobId=${job.ad_id}`;
        // Use the second organization unit if available, otherwise use the first one
        const organizationUnitName = job.organizations.length > 1 ? job.organizations[1].nameorgunit : job.organizations[0]?.nameorgunit || 'Not specified';
        return `
<div class="col-12 col-md-4 col-lg-4 mb-4">
    <a href="${jobDetailUrl}" class="" style="text-decoration: none; color: inherit;">
        <div class="card h-100">
            <div class="card-body">
		        <div class="card-category"><span>${organizationUnitName}</span></div>
                <h5 class="card-title">${job.title}</h5>
                <p class="card-text">${job.country}</p>
			    <a href="${jobDetailUrl}" class="stretched-link">
                <img src="./files/arrow-right-regular.svg" class="" alt="Details" style="">
		</a>
            </div>
        </div>
    </a>
</div>`;
    }

    // Function to update the visibility of the "Load More" button
    function updateLoadMoreVisibility() {
        if (displayedJobs >= jobs.length) {
            $('#loadMore').hide();
        } else {
            $('#loadMore').show();
        }
    }

    // Function to fetch jobs from the API
	$(document).ready(function () {
    const currentJobId = new URLSearchParams(window.location.search).get('jobId');
    fetchJobs(currentJobId); // Pass currentJobId to the fetchJobs function
});

function fetchJobs(currentJobId) {
    fetch('https://api.talentech.io/reachmee/feed/wistrand')
        .then(response => response.json())
        .then(data => {
            jobs = data.filter(job => job.ad_id !== parseInt(currentJobId));
            if (jobs.length === 0) {
                $('#tt-feature-section').hide();
            } else {
                displayedJobs = Math.min(jobsToShow, jobs.length);
                populateFilters();
                displayJobs();
            }
        })
        .catch(error => {
            console.error('Error fetching jobs:', error);
        });
}


    // Load jobs when page is ready
    fetchJobs();

    // Event listener for "Load More" button
    $('#loadMore').click(function() {
        displayedJobs += jobsToShow; // Increase the number of displayed jobs
        displayJobs(); // Display new set of jobs
        updateLoadMoreVisibility(); // Check if we still need the "Load More" button
    });

    // Event listeners for filter dropdowns
    $('#locationFilter').change(function() {
        displayedJobs = jobsToShow; // Reset displayed jobs to show initial count based on current device
        displayJobs(); // Apply filter and display jobs
        updateLoadMoreVisibility(); // Update "Load More" button visibility based on filters
    });

    $('#jobTypeFilter').change(function() {
        displayedJobs = jobsToShow; // Reset displayed jobs to show initial count based on current device
        displayJobs(); // Apply filter and display jobs
        updateLoadMoreVisibility(); // Update "Load More" button visibility based on filters
    });
});
</script>



	
<script>
$(document).ready(function() {
    const params = new URLSearchParams(window.location.search);
    // Get 'rmjob' if present, otherwise get 'jobId'
    const jobId = params.get('rmjob') ? parseInt(params.get('rmjob'), 10) : parseInt(params.get('jobId'), 10);

    fetch('https://api.talentech.io/reachmee/feed/wistrand')
        .then(response => response.json())
        .then(jobs => {
            const job = jobs.find(job => job.ad_id === jobId);
            if (job) {
                const organizationUnit = job.organizations && job.organizations.length > 1 ? job.organizations[1].nameorgunit : job.organizations[0]?.nameorgunit || 'Ikke spesifisert';
                const city = job.areas && job.areas.length > 0 ? job.areas[0].name : ' ';

                const applicationLink = job.link.replace("rmpage=job", "rmpage=apply");
                $('#applyButton').attr('onclick', `window.location.href='${applicationLink}'`);
                $('#applyButton-tt').attr('onclick', `window.location.href='${applicationLink}'`);

                // Set the page title to the job title
                document.title = job.title;

                // Display the job title in the designated area with formatting
                const titleWords = job.title.split(' ');
                const firstWord = titleWords.shift();
                const restOfTitle = titleWords.join(' ');
                $('.job-title').html(`<span style="font-weight:600;">${firstWord}</span> <span style="font-weight:600;">${restOfTitle}</span>`);

                // Update elements with job details
                $('.job-title2').html(job.title);
                $('.job-description').html(job.description);
                $('.organization-unit').text(organizationUnit);
                $('.city').text(city);
                $('.country').text(job.country);
                $('.publishing-date').text(job.publishing_date);
                $('.expiration-date').text(job.expiration_date);

                $('.contact-persons').empty();
                job.contact_persons.forEach((person) => {
                    const contactInfo = `
                        <div class="contact-person">
                            <p>${person.first_name} ${person.surname}, ${person.position}<br>
                            <a href="mailto:${person.email}">${person.email}</a><br>
                            <a href="tel:${person.phone}">${person.phone}</a></p>
                        </div>`;
                    $('.contact-persons').append(contactInfo);
                });

                // Handle additional dynamic elements
                let collectionId = 'no'; // Default to "no"
                if (organizationUnit === "Finance") {
                    collectionId = 'xdjc4'; // Specific ID for "Finance"
                } else if (organizationUnit === "Sales") {
                    collectionId = 'xdjc4'; // Example ID for "Sales"
                } else {
                    collectionId = 'xdjc4'; // Other org units
                }
                const newDiv = $('<div class="gobi-collection"></div>').attr('data-gobi-collection-id', collectionId);
                newDiv.insertAfter('#gobi-section');
                loadGobiScript();
            } else {
                $('.job-details').text('Job not found.');
            }
        })
        .catch(error => {
            console.error('Error fetching job details:', error);
            $('.job-details').text('Job details could not be loaded.');
        });

    function loadGobiScript() {
        const gobiScript = document.createElement('script');
        gobiScript.src = 'https://widget.gobistories.com/gwi/6';
        gobiScript.onload = function() {
            if (typeof gobi !== 'undefined' && gobi.discover) {
                gobi.discover();
            }
        };
        document.body.appendChild(gobiScript);
    }
});
</script>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const openApplication = urlParams.get('open-application');
    
    if (openApplication !== null) {
        // Change the src of the iframe
        const applicationFormIframe = document.getElementById('applicationFormIframe');
        applicationFormIframe.src = "https://web106.reachmee.com/ext/I002/233/apply?site=5&lang=NO&validator=b026c105ea4a83b928726cb7cb18488c&job_id=-1";
        
        // Hide the job description and metadata
        document.getElementById('our-process').style.display = 'none';
        document.getElementById('tt-job-section').style.display = 'none';
        document.getElementById('tt-talentech-section-1').style.display = 'none';
        document.getElementById('tt-talentech-section-2').style.display = 'none';
        document.getElementById('tt-feature-section').style.display = 'none';
        document.getElementById('appform-header').style.display = 'none';
        document.getElementById('position-title-meta').style.display = 'none';
        
        // Populate the position-title h1 with specific text
        const positionTitleH1 = document.getElementById('position-title');
        positionTitleH1.innerText = 'Join our talent pool';
    }
});

</script>


	
<script src="./js/share-some.js"></script>	
</body>

</html>
